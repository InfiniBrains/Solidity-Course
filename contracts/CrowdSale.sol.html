<!doctype html>
<html lang="en">
<head>
    <title>Code coverage report for contracts/CrowdSale.sol</title>
    <meta charset="utf-8" />
    <link rel="stylesheet" href="../prettify.css" />
    <link rel="stylesheet" href="../base.css" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style type='text/css'>
        .coverage-summary .sorter {
            background-image: url(../sort-arrow-sprite.png);
        }
    </style>
</head>
<body>
<div class='wrapper'>
  <div class='pad1'>
    <h1>
      <a href="../index.html">all files</a> / <a href="index.html">contracts/</a> CrowdSale.sol
    </h1>
    <div class='clearfix'>
      <div class='fl pad1y space-right2'>
        <span class="strong">0% </span>
        <span class="quiet">Statements</span>
        <span class='fraction'>0/26</span>
      </div>
      <div class='fl pad1y space-right2'>
        <span class="strong">0% </span>
        <span class="quiet">Branches</span>
        <span class='fraction'>0/48</span>
      </div>
      <div class='fl pad1y space-right2'>
        <span class="strong">0% </span>
        <span class="quiet">Functions</span>
        <span class='fraction'>0/14</span>
      </div>
      <div class='fl pad1y space-right2'>
        <span class="strong">0% </span>
        <span class="quiet">Lines</span>
        <span class='fraction'>0/35</span>
      </div>
    </div>
  </div>
  <div class='status-line low'></div>
<pre><table class="coverage">
<tr><td class="line-count quiet">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147</td><td class="line-coverage quiet"><span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span></td><td class="text"><pre class="prettyprint lang-js">// SPDX-License-Identifier: MIT
&nbsp;
pragma solidity ^0.8.9;
&nbsp;
import "@openzeppelin/contracts/access/Ownable.sol";
import "@openzeppelin/contracts/security/Pausable.sol";
import "@openzeppelin/contracts/token/ERC20/IERC20.sol";
import "@openzeppelin/contracts/utils/math/SafeMath.sol";
import "@openzeppelin/contracts/utils/Address.sol";
import "@openzeppelin/contracts/security/ReentrancyGuard.sol";
&nbsp;
contract CrowdSale is Ownable, Pausable, ReentrancyGuard {
    using SafeMath for uint256;
    using Address for address;
&nbsp;
    // the token to be sold
    IERC20 public _tokenContract;
&nbsp;
    // number of tokens already sold
    uint256 public _tokensSold;
&nbsp;
    // the time the campaign will start
    uint public _openingTime;
&nbsp;
    // the time the campaign will end
    uint public _closingTime;
&nbsp;
    // the rate conversion between bnb and the token
    uint256 public _rate;
&nbsp;
<span class="fstat-no" title="function not covered" >    constructor() {}</span>
&nbsp;
<span class="fstat-no" title="function not covered" >    function setTokenToSell(address tokenContractAddress) public onlyOwner {</span>
        _tokenContract = IERC20(tokenContractAddress);
<span class="cstat-no" title="statement not covered" >        emit SetTokenToSell(tokenContractAddress);</span>
    }
    event SetTokenToSell(address tokenContractAddress);
&nbsp;
    // ref https://docs.openzeppelin.com/contracts/2.x/crowdsales
    // rate: how much tokens each eth will give
    // supply: the ammout of tokens available in this campaign
    // closingTime: the time the campaign will end
    // openingTime: the time the campaign will start
<span class="fstat-no" title="function not covered" >    function configure(uint256 rate, uint openingTime, uint closingTime) public onlyOwner {</span>
<span class="cstat-no" title="statement not covered" >        require(openingTime &lt; closingTime, "openingTime must be lower than closingTime")</span>;
&nbsp;
        _rate = rate;
        _openingTime = openingTime;
        _closingTime = closingTime;
        _tokensSold = 0;
<span class="cstat-no" title="statement not covered" >        emit  Configure(rate, openingTime, closingTime);</span>
    }
    event Configure(uint256 rate, uint openingTime, uint closingTime);
&nbsp;
<span class="fstat-no" title="function not covered" >    function configureDates( uint openingTime, uint closingTime) public onlyOwner {</span>
<span class="cstat-no" title="statement not covered" >        require(openingTime &lt; closingTime, "openingTime must be lower than closingTime")</span>;
        _openingTime = openingTime;
        _closingTime = closingTime;
<span class="cstat-no" title="statement not covered" >        emit ConfigureDates(openingTime, closingTime);</span>
    }
    event ConfigureDates( uint openingTime, uint closingTime);
&nbsp;
<span class="fstat-no" title="function not covered" >    function configureRate( uint256 rate ) public onlyOwner {</span>
        _rate = rate;
<span class="cstat-no" title="statement not covered" >        emit ConfigureRate(rate);</span>
    }
    event ConfigureRate( uint256 rate );
&nbsp;
    // how many tokens you will receive for the amount of bnbs
<span class="fstat-no" title="function not covered" >    function bnb2token(uint256 units) public view returns (uint256){</span>
<span class="cstat-no" title="statement not covered" >        return units.mul(_rate).div(10**18);</span>
    }
&nbsp;
<span class="fstat-no" title="function not covered" >    function buyTokens() public payable whenNotPaused {</span>
<span class="cstat-no" title="statement not covered" >        require(block.timestamp &lt;= _closingTime, "Sale has finished")</span>;
<span class="cstat-no" title="statement not covered" >        require(_openingTime &lt;= block.timestamp, "Sale has not started yet")</span>;
<span class="cstat-no" title="statement not covered" >        require(msg.value &gt; 0, "You should send money in order to buy tokens")</span>;
<span class="cstat-no" title="statement not covered" >        uint256 numberOfTokens = bnb2token(msg.value);</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >        require(supply() &gt;= numberOfTokens, "Contract does not have enough tokens")</span>;
&nbsp;
<span class="cstat-no" title="statement not covered" >        require(_tokenContract.transfer(msg.sender, numberOfTokens), "Some problem with token transfer")</span>;
&nbsp;
        _tokensSold += numberOfTokens;
&nbsp;
<span class="cstat-no" title="statement not covered" >        emit Sell(msg.sender, numberOfTokens);</span>
    }
    event Sell(address _buyer, uint256 _amount);
&nbsp;
<span class="fstat-no" title="function not covered" >    function withdrawBNB(address to, uint256 amount) onlyOwner nonReentrant() public {</span>
<span class="cstat-no" title="statement not covered" >        uint256 balance = address(this).balance;</span>
<span class="cstat-no" title="statement not covered" >        require(amount&lt;=balance,"Amount greater than the balance")</span>;
<span class="cstat-no" title="statement not covered" >        Address.sendValue(payable(to), amount)</span>;
    }
&nbsp;
    /**
     * @dev Withdraw any ERC20 token from this contract
     * @param tokenAddress ERC20 token to withdraw
     * @param to receiver address
     * @param amount amount to withdraw
     */
<span class="fstat-no" title="function not covered" >    function withdrawERC20(</span>
        address tokenAddress,
        address to,
        uint256 amount
    ) external virtual nonReentrant() onlyOwner {
<span class="cstat-no" title="statement not covered" >        require(tokenAddress.isContract(), "ERC20 token address must be a contract")</span>;
&nbsp;
<span class="cstat-no" title="statement not covered" >        IERC20 tokenContract = IERC20(tokenAddress);</span>
<span class="cstat-no" title="statement not covered" >        require(</span>
            tokenContract.balanceOf(address(this)) &gt;= amount,
            "You are trying to withdraw more funds than available"
        );
&nbsp;
<span class="cstat-no" title="statement not covered" >        require(tokenContract.transfer(to, amount), "Fail on transfer")</span>;
    }
&nbsp;
<span class="fstat-no" title="function not covered" >    function totalBalance() external view returns(uint256) {</span>
<span class="cstat-no" title="statement not covered" >        return payable(address(this)).balance;</span>
    }
&nbsp;
<span class="fstat-no" title="function not covered" >    function supply() public view returns (uint256) {</span>
<span class="cstat-no" title="statement not covered" >        return _tokenContract.balanceOf(address(this));</span>
    }
&nbsp;
//    function endSale() public onlyOwner {
//        require(
//            _tokenContract.transfer(owner(), _tokenContract.balanceOf(address(this))),
//            "Unable to transfer tokens to admin"
//        );
//        // destroy contract and send ethers to the owner
//        // https://solidity-by-example.org/hacks/self-destruct/
////        selfdestruct(payable(owner()));
//    }
&nbsp;
<span class="fstat-no" title="function not covered" >    function pause() public onlyOwner whenNotPaused {</span>
<span class="cstat-no" title="statement not covered" >        _pause()</span>;
    }
&nbsp;
<span class="fstat-no" title="function not covered" >    function unPause() public onlyOwner whenPaused {</span>
<span class="cstat-no" title="statement not covered" >        _unpause()</span>;
    }
&nbsp;
<span class="fstat-no" title="function not covered" >    function isPaused() public view returns (bool) {</span>
<span class="cstat-no" title="statement not covered" >        return paused();</span>
    }
}</pre></td></tr>
</table></pre>
<div class='push'></div><!-- for sticky footer -->
</div><!-- /wrapper -->
<div class='footer quiet pad2 space-top1 center small'>
  Code coverage
  generated by <a href="http://istanbul-js.org/" target="_blank">istanbul</a> at Fri Mar 31 2023 22:21:47 GMT+0000 (Coordinated Universal Time)
</div>
</div>
<script src="../prettify.js"></script>
<script>
window.onload = function () {
        if (typeof prettyPrint === 'function') {
            prettyPrint();
        }
};
</script>
<script src="../sorter.js"></script>
</body>
</html>
